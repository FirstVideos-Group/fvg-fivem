<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fvg-traffipax ‚Äì Dokument√°ci√≥</title>
    <link rel="stylesheet" href="https://use.hugeicons.com/font/icons.css">
    <style>
        :root {
            --bg:#0f1117; --surface:#181c27; --border:rgba(255,255,255,0.08);
            --accent:#facc15; --red:#ef4444; --green:#22c55e;
            --text:#e2e8f0; --muted:rgba(255,255,255,0.45); --radius:12px;
            --mono:'JetBrains Mono','Fira Code',monospace;
        }
        *{margin:0;padding:0;box-sizing:border-box;}
        body{background:var(--bg);color:var(--text);font-family:'Segoe UI',system-ui,sans-serif;line-height:1.7;}
        .container{max-width:940px;margin:0 auto;padding:48px 24px;}
        h1{font-size:2rem;font-weight:800;margin-bottom:6px;}
        h1 span{color:var(--accent);}
        .tagline{color:var(--muted);margin-bottom:40px;font-size:.95rem;}
        h2{font-size:1.15rem;font-weight:700;margin:40px 0 14px;padding-bottom:8px;
           border-bottom:1px solid var(--border);display:flex;align-items:center;gap:8px;}
        h2 i{color:var(--accent);font-size:1.1rem;}
        p{color:rgba(255,255,255,.72);margin-bottom:12px;}
        code{background:rgba(255,255,255,.07);padding:2px 7px;border-radius:5px;
             font-family:var(--mono);font-size:.82em;color:#93c5fd;}
        pre{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);
            padding:20px 24px;overflow-x:auto;margin:14px 0 24px;}
        pre code{background:none;padding:0;color:#e2e8f0;font-size:.84rem;line-height:1.8;}
        .badge{display:inline-block;padding:2px 10px;border-radius:20px;font-size:.72rem;
               font-weight:700;letter-spacing:.5px;vertical-align:middle;margin-left:8px;}
        .badge-server{background:rgba(239,68,68,.18);color:#f87171;border:1px solid rgba(239,68,68,.3);}
        .badge-client{background:rgba(96,165,250,.18);color:#93c5fd;border:1px solid rgba(96,165,250,.3);}
        .badge-event {background:rgba(167,139,250,.18);color:#c4b5fd;border:1px solid rgba(167,139,250,.3);}
        .badge-config{background:rgba(250,204,21,.15);color:#fde047;border:1px solid rgba(250,204,21,.25);}
        table{width:100%;border-collapse:collapse;margin:14px 0 24px;}
        th{text-align:left;padding:10px 14px;background:var(--surface);color:var(--muted);
           font-size:.78rem;letter-spacing:.5px;text-transform:uppercase;border-bottom:1px solid var(--border);}
        td{padding:10px 14px;border-bottom:1px solid var(--border);color:rgba(255,255,255,.75);font-size:.88rem;}
        tr:last-child td{border-bottom:none;}
        .demo-box{background:var(--surface);border:1px solid var(--border);
                  border-radius:var(--radius);padding:24px;margin:16px 0 24px;}
        .demo-output{background:#0a0c12;border:1px solid var(--border);border-radius:8px;
                     padding:14px 18px;font-family:var(--mono);font-size:.82rem;
                     color:#4ade80;margin-top:14px;min-height:44px;line-height:1.8;}
        button{display:inline-flex;align-items:center;gap:7px;padding:8px 16px;
               border-radius:8px;border:1px solid var(--border);
               background:rgba(255,255,255,.07);color:var(--text);font-size:.85rem;
               cursor:pointer;margin:4px 4px 4px 0;transition:background .2s,transform .15s;}
        button:hover{background:rgba(255,255,255,.13);transform:translateY(-1px);}
        button:active{transform:translateY(0);}
        button i{font-size:15px;}

        /* Traffipax viz preview */
        .preview-zone{
            position:relative; height:180px;
            background:linear-gradient(135deg,#0a0c12 0%,#181c27 100%);
            border:1px solid var(--border); border-radius:var(--radius);
            overflow:hidden; margin:16px 0 24px;
            display:flex; align-items:center; justify-content:center;
        }
        .road{
            position:absolute; bottom:0; left:0; right:0; height:60px;
            background:#1a1a1a;
            border-top:2px solid #333;
        }
        .road::after{
            content:''; position:absolute; top:50%; left:0; right:0;
            height:3px; background:repeating-linear-gradient(
                90deg, #facc15 0px, #facc15 40px, transparent 40px, transparent 80px
            );
            transform:translateY(-50%);
        }
        .speed-camera{
            position:absolute; bottom:58px; right:80px;
            display:flex; flex-direction:column; align-items:center; gap:4px;
        }
        .speed-camera i{font-size:28px; color:var(--accent);}
        .camera-pole{
            width:3px; height:40px;
            background:linear-gradient(to bottom,#888,#555);
        }
        .speed-limit-sign{
            position:absolute; bottom:58px; left:80px;
            width:44px; height:44px; border-radius:50%;
            border:4px solid var(--red);
            background:#fff; display:flex; align-items:center; justify-content:center;
            font-weight:900; font-size:13px; color:#111;
        }
        .car-icon{
            position:absolute; bottom:14px; font-size:28px;
            transition:left 1.5s linear;
        }
        .flash-preview{
            position:absolute; inset:0;
            background:#fff; opacity:0;
            pointer-events:none;
            transition:opacity 0.08s;
            border-radius:var(--radius);
        }
        .flash-preview.pop{opacity:0.7;}
        .fine-tag{
            position:absolute; top:16px; left:50%; transform:translateX(-50%);
            padding:5px 14px; border-radius:20px;
            background:rgba(239,68,68,.18); border:1px solid rgba(239,68,68,.35);
            font-size:12px; font-weight:700; color:#f87171;
            opacity:0; transition:opacity 0.3s;
        }
        .fine-tag.show{opacity:1;}
    </style>
</head>
<body>
<div class="container">

    <h1><span>fvg</span>-traffipax</h1>
    <p class="tagline">Automatikus sebess√©gm√©r≈ë √©s b√ºntet√©si rendszer ‚Äì zs√≥na alapon, banking √©s emergency integr√°ci√≥val</p>

    <!-- Hogyan m≈±k√∂dik -->
    <h2><i class="hgi-stroke hgi-information-circle"></i> Hogyan m≈±k√∂dik</h2>
    <p>
        A kliens <code>CheckInterval</code> ms-enk√©nt m√©ri a j√°rm≈± sebess√©g√©t.
        Ha a j√°t√©kos egy z√≥na <code>range</code>-√©n bel√ºl van √©s t√∫lfogja a
        <code>limit</code>-et, szerver-esem√©nyt k√ºld. A szerver cooldown ut√°n
        levonj a b√≠rss√°got (k√©szp√©nz √©s/vagy bank), √©rtes√≠ti a rend≈ër√∂ket,
        √©s s√∫lyos t√∫lsebesss√©g eset√©n BOLO-t ad ki.
    </p>

    <!-- Traffipax el≈ën√©zet animaci√≥ -->
    <h2><i class="hgi-stroke hgi-camera-01"></i> Vizualizaci√≥</h2>
    <div class="preview-zone" id="preview-zone">
        <div class="road"></div>
        <div class="speed-camera">
            <i class="hgi-stroke hgi-camera-01"></i>
            <div class="camera-pole"></div>
        </div>
        <div class="speed-limit-sign" id="preview-limit">50</div>
        <div class="car-icon" id="preview-car" style="left:-40px;">&#x1F697;</div>
        <div class="flash-preview" id="flash-preview"></div>
        <div class="fine-tag" id="fine-tag">B√≠rss√°g: $800</div>
    </div>
    <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:32px;">
        <button onclick="demoNormal()"><i class="hgi-stroke hgi-checkmark-circle-02" style="color:#22c55e;"></i>Norm√°l menetel</button>
        <button onclick="demoSpeeding()"><i class="hgi-stroke hgi-alert-circle" style="color:#ef4444;"></i>Gyorshajtl√°s</button>
        <button onclick="demoHeavy()"><i class="hgi-stroke hgi-alert-diamond" style="color:#f59e0b;"></i>S√∫lyos gyorshajtl√°s (+BOLO)</button>
    </div>

    <!-- Konfigur√°ci√≥ -->
    <h2><i class="hgi-stroke hgi-settings-01"></i> Konfigur√°ci√≥ <span class="badge badge-config">config.lua</span></h2>
    <table>
        <tr><th>Kulcs</th><th>Alap√©rt√©k</th><th>Le√≠r√°s</th></tr>
        <tr><td><code>Zones[].limit</code></td><td>50‚Äì100</td><td>Sebess√©ghat√°r km/h-ban</td></tr>
        <tr><td><code>Zones[].range</code></td><td>40‚Äì80</td><td>√ârz√©kel√©si sug√°r m√©terben</td></tr>
        <tr><td><code>Zones[].fine</code></td><td>600‚Äì1200</td><td>Alap b√≠rss√°g ($)</td></tr>
        <tr><td><code>BOLOThreshold</code></td><td>40</td><td>T√∫lsebesss√©g km/h, felette BOLO</td></tr>
        <tr><td><code>FineMethod</code></td><td>'both'</td><td>'cash' | 'bank' | 'both'</td></tr>
        <tr><td><code>FineCooldown</code></td><td>60000</td><td>Cooldown k√©t b√ºntet√©s k√∂z√∂tt (ms)</td></tr>
        <tr><td><code>CheckInterval</code></td><td>500</td><td>Sebess√©g-ellen≈ërz√©s intervallum (ms)</td></tr>
        <tr><td><code>WarnRange</code></td><td>80.0</td><td>Figyelmeztets√© sug√°r (m)</td></tr>
        <tr><td><code>NotifyPolice</code></td><td>true</td><td>Szolg√°latban l√©v≈ë rend≈ër√∂k √©rtes√≠t√©se</td></tr>
    </table>

    <!-- B√≠rss√°g szorz√≥k -->
    <h2><i class="hgi-stroke hgi-multiply-sign"></i> B√≠rss√°g szorz√≥k</h2>
    <table>
        <tr><th>T√∫lsebesss√©g</th><th>Szorz√≥</th><th>P√©lda ($800 alap)</th></tr>
        <tr><td>1‚Äì10 km/h</td><td>1.0√ó</td><td>$800</td></tr>
        <tr><td>11‚Äì20 km/h</td><td>1.5√ó</td><td>$1 200</td></tr>
        <tr><td>21‚Äì30 km/h</td><td>2.0√ó</td><td>$1 600</td></tr>
        <tr><td>31‚Äì40 km/h</td><td>3.0√ó</td><td>$2 400</td></tr>
        <tr><td>41+ km/h</td><td>4.5√ó + BOLO</td><td>$3 600 + BOLO</td></tr>
    </table>

    <!-- Szerver exportok -->
    <h2><i class="hgi-stroke hgi-code"></i> Szerver exportok <span class="badge badge-server">SERVER</span></h2>
    <table>
        <tr><th>Export</th><th>Param√©ter</th><th>Visszat√©r√©s</th><th>Le√≠r√°s</th></tr>
        <tr><td><code>GetFineLog(limit)</code></td><td>limit: number</td><td>table[]</td><td>Utols√≥ N b√ºntet√©s rekordja</td></tr>
        <tr><td><code>GetZones()</code></td><td>‚Äì</td><td>table[]</td><td>√ñsszes z√≥na √°llapottal</td></tr>
        <tr><td><code>GetZoneState(zoneId)</code></td><td>zoneId: string</td><td>boolean</td><td>Z√≥na be-e kapcsolva</td></tr>
        <tr><td><code>SetZoneState(zoneId, state)</code></td><td>zoneId: string, state: bool</td><td>boolean</td><td>Z√≥na be/ki kapcsol√°sa</td></tr>
        <tr><td><code>IssueFineManual(src, zoneId, kmh)</code></td><td>src, zoneId: string, kmh: number</td><td>boolean, number</td><td>K√©zi b√ºntet√©s kiszab√°sa</td></tr>
    </table>

    <!-- Kliens exportok -->
    <h2><i class="hgi-stroke hgi-code"></i> Kliens exportok <span class="badge badge-client">CLIENT</span></h2>
    <table>
        <tr><th>Export</th><th>Visszat√©r√©s</th><th>Le√≠r√°s</th></tr>
        <tr><td><code>GetNearbyZone()</code></td><td>table|nil</td><td>Legk√∂zelebbi akt√≠v z√≥na</td></tr>
        <tr><td><code>IsInZone()</code></td><td>boolean, table|nil</td><td>Z√≥n√°n bel√ºl van-e a j√°t√©kos</td></tr>
    </table>

    <!-- Esem√©ny hook-ok -->
    <h2><i class="hgi-stroke hgi-notification-02"></i> Esem√©ny hook-ok <span class="badge badge-event">EVENTS</span></h2>
    <table>
        <tr><th>Esem√©ny</th><th>Oldal</th><th>Param√©terek</th></tr>
        <tr><td><code>fvg-traffipax:server:FineIssued</code></td><td>Server</td><td>src, record{name,plate,zoneLabel,speed,limit,fine,paid,time}</td></tr>
    </table>

    <!-- Integr√°ci√≥k -->
    <h2><i class="hgi-stroke hgi-plug-socket"></i> Integr√°ci√≥k</h2>
    <table>
        <tr><th>Script</th><th>Hogyan</th></tr>
        <tr><td><code>fvg-playercore</code></td><td>Bet√∂lt√©s detekt√°l√°s, k√©szp√©nz levon√°s (<code>GetPlayerData/SetPlayerData</code>)</td></tr>
        <tr><td><code>fvg-banking</code></td><td><code>RemoveBalance(src, fine, 'checking', ...)</code> ‚Äì bankb√≥l vonja le ha nincs k√©szp√©nz</td></tr>
        <tr><td><code>fvg-notify</code></td><td>J√°t√©kos + rend≈ër √©rtes√≠t√©sek (<code>warning</code> / <code>police</code> t√≠pus)</td></tr>
        <tr><td><code>fvg-police</code></td><td><code>GetOnDutyOfficers()</code> ‚Äì szolg√°latban l√©v≈ë rend≈ër√∂k kiad√©rtes√≠t√©se</td></tr>
        <tr><td><code>fvg-emergency</code></td><td><code>IssueBOLO(plate, desc)</code> ‚Äì s√∫lyos t√∫lsebesss√©gn√©l automatikus BOLO</td></tr>
    </table>

    <!-- P√©lda k√≥dok -->
    <h2><i class="hgi-stroke hgi-code-circle"></i> P√©lda ‚Äì m√°s scriptb≈ël</h2>
    <pre><code>-- Utols√≥ 10 b√ºntet√©s lek√©rdez√©se (pl. rend≈ër MDT)
local log = exports['fvg-traffipax']:GetFineLog(10)
for _, r in ipairs(log) do
    print(r.name, r.plate, r.speed, r.fine)
end

-- Z√≥na ideiglenes kikapcsol√°sa (pl. rend≈ëri esemsom√©ny)
exports['fvg-traffipax']:SetZoneState('downtown_1', false)

-- K√©zi b√ºntet√©s kiszab√°sa (rend≈ër scriptb≈ël)
local ok, fine = exports['fvg-traffipax']:IssueFineManual(src, 'downtown_1', 85)

-- Esem√©ny figyel√©s (pl. admin log)
AddEventHandler('fvg-traffipax:server:FineIssued', function(src, record)
    print(record.name .. ' | ' .. record.plate .. ' | $' .. record.fine)
end)</code></pre>

    <!-- Interakt√≠v demo -->
    <h2><i class="hgi-stroke hgi-test-tube"></i> Interakt√≠v demo</h2>
    <div class="demo-box">
        <p style="margin-bottom:14px;">Szimul√°lja a traffipax m≈±k√∂d√©s√©t:</p>
        <div style="display:flex;flex-wrap:wrap;gap:8px;">
            <button onclick="demoFine(60,50,800)"><i class="hgi-stroke hgi-camera-01" style="color:#facc15;"></i>60 km/h (hat√°r 50)</button>
            <button onclick="demoFine(80,50,800)"><i class="hgi-stroke hgi-camera-01" style="color:#f59e0b;"></i>80 km/h (hat√°r 50)</button>
            <button onclick="demoFine(110,50,800)"><i class="hgi-stroke hgi-camera-01" style="color:#ef4444;"></i>110 km/h + BOLO</button>
            <button onclick="demoZoneToggle()"><i class="hgi-stroke hgi-toggle-on"></i>Z√≥na toggle</button>
            <button onclick="demoClear()"><i class="hgi-stroke hgi-refresh"></i>Reset</button>
        </div>
        <div class="demo-output" id="demo-out">Nyomj egy gombot...</div>
    </div>

</div>

<script>
    let zoneEnabled = true;
    const muls = [
        {over:40, mul:4.5},
        {over:30, mul:3.0},
        {over:20, mul:2.0},
        {over:10, mul:1.5},
        {over:0,  mul:1.0},
    ];
    function getMul(over) {
        for (const r of muls) if (over >= r.over) return r.mul;
        return 1.0;
    }
    function out(msg) {
        const el = document.getElementById('demo-out');
        el.innerHTML = msg;
    }
    function demoFine(speed, limit, base) {
        if (!zoneEnabled) { out('‚ö† Z√≥na kikapcsolva ‚Äì nincs b√ºntet√©s.'); return; }
        const over = speed - limit;
        if (over <= 0) { out('‚úì Nem haladta meg a hat√°rt.'); return; }
        const mul  = getMul(over);
        const fine = Math.floor(base * mul);
        const bolo = over >= 40;
        out(`üì∏ Traffipax r√∂gz√≠tett: <b>${speed} km/h</b> (hat√°r ${limit}) | T√∫lsebesss√©g: +${over} km/h | Szorz√≥: ${mul}√ó<br>` +
            `üí∏ B√≠rss√°g: <b style="color:#ef4444;">$${fine.toLocaleString()}</b><br>` +
            (bolo ? `üî¥ <b>BOLO kiadva</b> ‚Äì s√∫lyos t√∫lsebesss√©g!` : `‚úÖ Nincs BOLO (t√∫lsebesss√©g ${over} km/h &lt; 40)`)
        );
    }
    function demoNormal() { demoFine(45, 50, 800); }
    function demoSpeeding() { demoFine(75, 50, 800); }
    function demoHeavy() { demoFine(120, 50, 800); }
    function demoZoneToggle() {
        zoneEnabled = !zoneEnabled;
        out(zoneEnabled
            ? '‚ñ∂ SetZoneState("downtown_1", true) ‚Äì Z√≥na bekapcsolva.'
            : '‚ñ† SetZoneState("downtown_1", false) ‚Äì Z√≥na kikapcsolva.');
    }
    function demoClear() {
        zoneEnabled = true;
        out('Nyomj egy gombot...');
    }

    // Preview anim√°ci√≥ k√≥d (f≈ëoldalon)
    function demoNormal() {
        const car = document.getElementById('preview-car');
        if (!car) return;
        car.style.left = '-40px';
        void car.offsetWidth;
        car.style.left = '110%';
        out('‚úì Norm√°l sebessg√© ‚Äì nincs b√ºntet√©s.');
    }
    function demoSpeeding() {
        const car   = document.getElementById('preview-car');
        const flash = document.getElementById('flash-preview');
        const tag   = document.getElementById('fine-tag');
        if (!car) return;
        car.style.left = '-40px';
        void car.offsetWidth;
        car.style.transition = 'left 0.6s linear';
        car.style.left = '110%';
        setTimeout(() => {
            flash.classList.add('pop');
            tag.classList.add('show');
            setTimeout(() => { flash.classList.remove('pop'); }, 150);
            setTimeout(() => { tag.classList.remove('show'); car.style.transition = 'left 1.5s linear'; }, 2500);
        }, 350);
        demoFine(75, 50, 800);
    }
    function demoHeavy() {
        const car   = document.getElementById('preview-car');
        const flash = document.getElementById('flash-preview');
        const tag   = document.getElementById('fine-tag');
        if (tag) tag.textContent = 'B√≠rss√°g: $3 600 + BOLO!';
        if (car) {
            car.style.left = '-40px';
            void car.offsetWidth;
            car.style.transition = 'left 0.35s linear';
            car.style.left = '110%';
        }
        setTimeout(() => {
            if (flash) { flash.classList.add('pop'); setTimeout(() => flash.classList.remove('pop'), 150); }
            if (tag)   { tag.classList.add('show'); setTimeout(() => { tag.classList.remove('show'); if(car) car.style.transition = 'left 1.5s linear'; }, 2500); }
        }, 200);
        demoFine(120, 50, 800);
    }
</script>
</body>
</html>
